<div align="center">

![Repo Badge](https://img.shields.io/badge/NT106_Quan_Ly_Kho_NHOM12-16a34a?style=for-the-badge&logo=github&logoColor=white)

# ğŸ“¦ á»¨ng dá»¥ng Quáº£n lÃ½ Nháº­p Xuáº¥t Kho
### NT106_QuanLyKho_Nhom12

[![License](https://img.shields.io/badge/License-MIT-green?style=flat-square&logo=opensourceinitiative&logoColor=white)](LICENSE)
![Python](https://img.shields.io/badge/Backend-FastAPI_%7C_Python-3776AB?style=flat-square&logo=python&logoColor=white)
![React](https://img.shields.io/badge/Frontend-React_%7C_Tauri-61DAFB?style=flat-square&logo=react&logoColor=black)
![Status](https://img.shields.io/badge/Status-Active-brightgreen?style=flat-square)

<p><b>Má»¥c tiÃªu:</b> á»¨ng dá»¥ng quáº£n lÃ½ tá»“n kho hiá»‡u quáº£ vá»›i nháº­p/xuáº¥t hÃ ng, tÃ­nh toÃ¡n COGS theo FIFO, bÃ¡o cÃ¡o lá»£i nhuáº­n chÃ­nh xÃ¡c vÃ  trá»£ lÃ½ AI tÃ­ch há»£p.</p>

</div>

---

## ğŸ”¸ TÃ³m táº¯t nhanh
- **Há»‡ thá»‘ng 2 thÃ nh pháº§n**: Backend FastAPI + Frontend React/Tauri (Desktop + Web Dev Server)
- **XÃ¡c thá»±c**: JWT + OTP email, Passkey cho thao tÃ¡c nguy hiá»ƒm, RBAC (Admin/Manager/Staff)
- **Quáº£n lÃ½ kho**: Sáº£n pháº©m, nhÃ  cung cáº¥p, nhiá»u kho; phiáº¿u nháº­p/xuáº¥t, há»§y phiáº¿u, cáº­p nháº­t tá»“n
- **BÃ¡o cÃ¡o & FIFO**: COGS tá»± Ä‘á»™ng báº±ng FIFO, lá»£i nhuáº­n chÃ­nh xÃ¡c, Excel/PDF export
- **TÃ­nh nÄƒng AI**: Chatbot Gemini, Chat realtime WebSocket, Upload tá»‡p
- **TÃ¬m kiáº¿m**: Global search, gá»£i Ã½ nhanh, tÄ©nh phá»¥c vá»¥ uploads

## ğŸŸ¢ NhÃ³m phÃ¡t triá»ƒn (NT106 - UIT)
| STT | Há» vÃ  tÃªn | MSSV | Vai trÃ² |
|:---:|:---:|:---:|:---|
| 1 | **HoÃ ng XuÃ¢n Minh TrÃ­** | 24521829 | Fullstack / Leader |
| 2 | **TrÆ°Æ¡ng Minh ThÃ¡i** | 24521599 | Frontend Dev |
| 3 | **Nguyá»…n VÃµ Minh TrÃ­** | 24521840 | Backend Dev |
| 4 | **Nguyá»…n VÄƒn Nam** | 24521120 | Fullstack |

## âœ¨ TÃ­nh nÄƒng chÃ­nh

### ğŸ“¦ Quáº£n lÃ½ hÃ ng hÃ³a
- Sáº£n pháº©m vá»›i danh má»¥c, giÃ¡ mua/bÃ¡n, hÃ¬nh áº£nh
- NhÃ  cung cáº¥p liÃªn káº¿t vá»›i sáº£n pháº©m
- Nhiá»u kho vá»›i tá»“n riÃªng biá»‡t
- Cáº£nh bÃ¡o tá»“n tháº¥p, tÃ¬m kiáº¿m nÃ¢ng cao

### ğŸ“‘ Nghiá»‡p vá»¥ kho
- Phiáº¿u nháº­p hÃ ng (Purchase Orders)
- Phiáº¿u xuáº¥t hÃ ng (Sales Orders) 
- Há»§y phiáº¿u vá»›i log chi tiáº¿t
- Cáº­p nháº­t tá»“n kho tá»©c thá»i
- Lá»‹ch sá»­ giao dá»‹ch Ä‘áº§y Ä‘á»§

### ğŸ’° BÃ¡o cÃ¡o & FIFO
- **FIFO Inventory Valuation**: TÃ­nh COGS tá»± Ä‘á»™ng báº±ng FIFO
- Lá»£i nhuáº­n = Doanh sá»‘ - COGS (chÃ­nh xÃ¡c)
- Export bÃ¡o cÃ¡o Excel/PDF
- PhÃ¢n tÃ­ch lá»£i nhuáº­n theo sáº£n pháº©m/kho
- GiÃ¡ trá»‹ tá»“n kho tÃ­nh toÃ¡n FIFO

### ğŸ”’ Báº£o máº­t & PhÃ¢n quyá»n
- JWT token vá»›i OTP email
- Passkey cho xÃ³a/há»§y
- RBAC 3 cáº¥p: Admin/Manager/Staff
- Lá»‹ch sá»­ Ä‘Äƒng nháº­p, hoáº¡t Ä‘á»™ng

### ğŸ¤– AI & Chat
- Chatbot Gemini há»— trá»£ hÆ°á»›ng dáº«n sá»­ dá»¥ng
- Chat realtime qua WebSocket
- Upload tá»‡p trong chat
- ThÃ´ng bÃ¡o tá»©c thá»i

### ğŸ” TÃ¬m kiáº¿m & UX
- Global search toÃ n há»‡ thá»‘ng
- Gá»£i Ã½ nhanh, autocomplete
- Dark/Light theme, customize chat wallpaper
- Responsive Desktop/Web

## ğŸ—ï¸ Kiáº¿n trÃºc & thÆ° má»¥c
```tree
NT106_QuanLyKho/
â”œâ”€ KhoHang_API/          # Backend FastAPI, SQLite/Postgres, AI client
â”‚  â”œâ”€ app/               # MÃ£ nguá»“n chÃ­nh (auth, inventory, export, chat...)
â”‚  â”œâ”€ data/              # ThÆ° má»¥c dá»¯ liá»‡u, uploads (tá»± táº¡o náº¿u chÆ°a cÃ³)
â”‚  â””â”€ .env.example       # Cáº¥u hÃ¬nh backend máº«u
â”œâ”€ UI_Desktop/           # Frontend React + Tauri (desktop), Vite + Tailwind
â”‚  â”œâ”€ src/               # UI, features, hooks, services
â”‚  â”œâ”€ src-tauri/         # Cáº¥u hÃ¬nh Tauri/Rust
â”‚  â””â”€ .env.example       # Cáº¥u hÃ¬nh frontend máº«u
â”œâ”€ start_app.bat         # Cháº¡y backend + frontend cÃ¹ng lÃºc (Windows)
â”œâ”€ start_backend.bat     # Cháº¡y FastAPI dev server
â”œâ”€ start_frontend.bat    # Cháº¡y Tauri dev
â”œâ”€ start_client1.bat     # Cháº¡y web dev táº¡i port 5173
â”œâ”€ start_client2.bat     # Cháº¡y web dev táº¡i port 5174
â””â”€ README.md
```

## ğŸ› ï¸ YÃªu cáº§u
- Python 3.10+ (khuyáº¿n nghá»‹ 3.11), pip, venv
- Node.js 18+ vÃ  npm
- Rust + Cargo (báº¯t buá»™c náº¿u cháº¡y Tauri desktop)
- SMTP (Gmail) cho OTP email; khÃ³a Gemini API cho chatbot (tÃ¹y chá»n)
- SQLite máº·c Ä‘á»‹nh; cÃ³ thá»ƒ chuyá»ƒn Postgres qua `DATABASE_URL`

## ğŸ”§ Cáº¥u hÃ¬nh mÃ´i trÆ°á»ng
**Backend**: sao chÃ©p [KhoHang_API/.env.example](KhoHang_API/.env.example) thÃ nh `.env` vÃ  chá»‰nh:
- `JWT_SECRET`, `JWT_ALGORITHM`, `JWT_EXP_DAYS`
- `SMTP_HOST`, `SMTP_PORT`, `SMTP_USER`, `SMTP_PASS`, `FROM_EMAIL`
- `DATABASE_URL` (bá» trá»‘ng Ä‘á»ƒ dÃ¹ng SQLite `data.db` máº·c Ä‘á»‹nh)
- `GEMINI_API_KEY` (tÃ¹y chá»n, báº­t chatbot)

**Frontend**: sao chÃ©p [UI_Desktop/.env.example](UI_Desktop/.env.example) thÃ nh `.env` vÃ  chá»‰nh:
- `VITE_API_BASE_URL=http://localhost:8000` (hoáº·c URL deployment)

## ğŸš€ Cháº¡y nhanh (Windows)

### 1ï¸âƒ£ Cháº¡y toÃ n bá»™ (Simple)
```bash
start_app.bat
```
- Tá»± cÃ i Ä‘áº·t dependencies
- Khá»Ÿi Ä‘á»™ng Backend FastAPI (port 8000)
- Khá»Ÿi Ä‘á»™ng Frontend Tauri Desktop

### 2ï¸âƒ£ Cháº¡y Backend & Frontend riÃªng biá»‡t
```bash
# Terminal 1: Backend
start_backend.bat

# Terminal 2: Frontend
start_frontend.bat
```

### 3ï¸âƒ£ Cháº¡y Web Dev Server (thay Tauri)
```bash
# Terminal 1: Backend
start_backend.bat

# Terminal 2: Web Client (port 5173)
start_client1.bat

# Hoáº·c second client (port 5174)
start_client2.bat
```

## ğŸ§© Cháº¡y thá»§ cÃ´ng (khÃ´ng dÃ¹ng .bat)

### Backend (FastAPI)
```bash
cd KhoHang_API

# Setup environment
python -m venv .venv
.venv\Scripts\activate  # Windows
# source .venv/bin/activate  # Linux/Mac

# Install & run
pip install -r requirements.txt
uvicorn app.main:app --reload
```
- API docs: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

### Frontend (React + Tauri)
```bash
cd UI_Desktop

# Install dependencies
npm install

# Desktop (Tauri)
npm run tauri dev

# Hoáº·c Web Dev Server
npm run dev -- --port 5173 --host
```

## ğŸ”§ Cáº¥u hÃ¬nh

### Backend (.env)
```bash
cd KhoHang_API
cp .env.example .env
# Chá»‰nh sá»­a:
# - JWT_SECRET, JWT_ALGORITHM, JWT_EXP_DAYS
# - SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASS, FROM_EMAIL (OTP)
# - DATABASE_URL (SQLite máº·c Ä‘á»‹nh, hoáº·c Postgres)
# - GEMINI_API_KEY (AI chatbot - optional)
```

### Frontend (.env)
```bash
cd UI_Desktop
cp .env.example .env
# Chá»‰nh sá»­a:
# - VITE_API_BASE_URL=http://localhost:8000
```

## ğŸ’¾ Quáº£n lÃ½ dá»¯ liá»‡u

### CÆ¡ sá»Ÿ dá»¯ liá»‡u
- **SQLite** (máº·c Ä‘á»‹nh): `KhoHang_API/data/data.db`
- **PostgreSQL**: Äáº·t `DATABASE_URL` trong `.env`
- Migration tá»± Ä‘á»™ng khi cháº¡y app

### Uploads & Files
- ÄÆ°á»ng dáº«n: `KhoHang_API/data/uploads/`
- Loáº¡i: avatars, chat_files, chatbot, logos, rt_files
- Phá»¥c vá»¥ tÄ©nh qua `/uploads/*`
- ThÆ° má»¥c táº¡o tá»± Ä‘á»™ng láº§n Ä‘áº§u cháº¡y

## ğŸŒ¿ Branching Strategy
- `main`: Production ready
- `dev`: Development branch
- `feat/<tÃªn-tÃ­nh-nÄƒng>`: Feature branches
- Táº¡o PR Ä‘á»ƒ merge vÃ o `dev` trÆ°á»›c

## ğŸ“ Script Utilities

### Backend
- `seed_admin.py`: Táº¡o tÃ i khoáº£n Admin máº·c Ä‘á»‹nh
- `reset_database.py`: Reset DB (development only)
- `test_inventory_valuation.py`: Test FIFO logic
- `test_export.py`: Test export Excel/PDF
- `check_db_schema.py`: Kiá»ƒm tra schema DB
- CÃ¡c script migrate schema náº¿u cáº§n

### Frontend
- `npm run build`: Build production
- `npm run preview`: Preview build
- `npm run lint`: Code linting

## ğŸ› Troubleshooting

| Váº¥n Ä‘á» | Giáº£i phÃ¡p |
|--------|----------|
| `ModuleNotFoundError: No module named 'app'` | Cháº¡y tá»« thÆ° má»¥c `KhoHang_API` |
| `CORS error` | Kiá»ƒm tra `VITE_API_BASE_URL` trong `.env` frontend |
| `SQLite database is locked` | ÄÃ³ng terminal khÃ¡c cháº¡y backend, restart |
| `Port 8000/5173 already in use` | Äá»•i port hoáº·c kill process Ä‘ang dÃ¹ng |
| `Missing .env file` | Copy `.env.example` â†’ `.env` |

## ğŸ“š TÃ i liá»‡u chi tiáº¿t

### Backend Architecture
- **Models**: Database schemas (Product, Warehouse, StockIn/Out, User, etc)
- **Routes**: Auth, User, Inventory, Export, Chatbot, Chat realtime
- **Services**: Inventory valuation (FIFO), Export, Search, AI client
- **RBAC**: Role-based access control middleware
- **Security**: JWT, OTP, Passkey validation

### Frontend Architecture
- **Features**: Auth, Dashboard, Items, Stock, Warehouses, Suppliers, Reports
- **Components**: Layout, Chat, Theme, UI utilities
- **State**: Zustand stores (auth, chat, notifications, theme)
- **Services**: API client, WebSocket chat, Authentication
- **Themes**: Customizable chat wallpapers, dark/light modes

## ğŸ“ FIFO Inventory Valuation

Há»‡ thá»‘ng tÃ­nh **COGS (Cost of Goods Sold)** theo FIFO:
```
Nháº­p 10x @ 100k, nháº­p 10x @ 150k
Xuáº¥t 15x @ 200k
â†’ COGS = 10Ã—100k + 5Ã—150k = 1,750k
â†’ Lá»£i nhuáº­n = (15Ã—200k) - 1,750k = 1,250k âœ“
```

Táº¥t cáº£ bÃ¡o cÃ¡o lá»£i nhuáº­n Ä‘á»u dá»±a trÃªn FIFO COGS chÃ­nh xÃ¡c.

## ğŸ¤ ÄÃ³ng gÃ³p
- Fork dá»± Ã¡n
- Táº¡o nhÃ¡nh `feat/<tÃªn-tÃ­nh-nÄƒng>`
- Commit changes vá»›i message rÃµ rÃ ng
- Push & táº¡o Pull Request
- Chá» review & merge

## ğŸ“„ License
MIT License - Tá»± do sá»­ dá»¥ng vÃ  phÃ¢n phá»‘i

---

<div align="center">
  <b>Dá»± Ã¡n mÃ´n há»c NT106 - UIT</b><br>
  <i>á»¨ng dá»¥ng Quáº£n lÃ½ Nháº­p Xuáº¥t Kho</i><br>
  <b>2025</b>
</div>
